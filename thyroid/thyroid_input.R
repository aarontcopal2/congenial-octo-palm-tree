#!/usr/bin/env Rscript
args = commandArgs(trailingOnly=TRUE)

if (length(args)==0) {
  stop("9 arguments must be supplied ", call.=FALSE)
} else{
  
  thetaVector <- list()
  thetaVector[[1]] <- array(1,dim = c(6,19))
  thetaVector[[2]] <- matrix(1,nrow = 4,ncol = 7)
  thetaVector[[3]] <- matrix(1,nrow = 1,ncol = 5)
  
  # to store actual values of computation
  nodes1 <- matrix(2,nrow = 19,ncol = 1)
  nodes2 <- matrix(2,nrow = 7,ncol = 1)
  nodes3 <- matrix(2,nrow = 5,ncol = 1)
  
  mean1 <- c(54.1107784,6.0036997,1.9133447,106.6455518,0.9830368,109.9385800)
  sd1 <- c(17.8917047,24.5721684,0.9523384,44.2637176,0.2264368,40.8490490)
  nodes1 <- as.numeric(as.character(args))
  # nodes1 <- c(1,45,0,0,0,0,0,0,0,0,0,0,0,0,1.90,1,82,0.73,112)
  nodes1[2] <- (nodes1[2]-mean1[1])/sd1[1]
  nodes1[15] <- (nodes1[15]-mean1[2])/sd1[2]
  nodes1[16] <- (nodes1[16]-mean1[3])/sd1[3]
  nodes1[17] <- (nodes1[17]-mean1[4])/sd1[4]
  nodes1[18] <- (nodes1[18]-mean1[5])/sd1[5]
  nodes1[19] <- (nodes1[19]-mean1[6])/sd1[6]
  
  thetaVector[[1]][1,] <- c( 3.184092506,-0.2104124,0.9447944,-0.36752699, 3.5133108,-0.2384542, 2.6730670,-2.3557106,-0.351090, 0.1036154,1.82233249, 0.9985610, 1.0000972, 0.6079438, 4.775772, 3.1452026,-3.4395866, 2.48948976, 1.681510)
  thetaVector[[1]][2,] <- c( 0.009643093, 0.3509314,1.4443006, 1.12208674, 0.5970475, 2.5904003, 2.9072248,-4.4291315, 2.797048, 0.2930750,0.46032079, 2.9687844, 0.9999666,-1.7625798,-4.750613, 0.7793923,-2.9173215, 2.28854046, 1.172772)
  thetaVector[[1]][3,] <- c( 1.647890188, 1.4863741,2.5659085, 1.07931475, 1.2858743, 2.9841338, 3.9833602,-5.1134703, 1.050675, 0.3028193,3.99790875, 0.1026013,-0.2000006,-1.1522944, 1.033473, 0.2363663, 2.1000610,-1.98425868,-3.035500)
  thetaVector[[1]][4,] <- c( 4.386108572, 0.5212237,3.1936306, 1.20918766,-1.8858095,-2.9404623, 2.0230918,-2.6164069, 3.973613, 0.4060316,0.07118827,-0.3178324, 1.0000005,-1.9345198, 2.794238,-1.8399175,-0.9190690, 2.24616280,-2.253341)
  thetaVector[[1]][5,] <- c( 4.008665836, 0.4591512,0.3073554, 0.98577795,-3.2002585,-3.7802401,-0.6702778, 1.0461468, 1.230488, 0.2034262,0.20434906, 0.2067138, 3.0000001,-2.4942762,-2.701160, 7.4950515,-0.8636152, 0.02824073, 2.085857)
  thetaVector[[1]][6,] <- c(-4.666187310,-0.2886736,2.4423188, 0.01775112,-0.1310706,-0.9739892, 1.8423114, 0.1882513, 1.900365,-2.0015595,2.85699003, 0.7936993, 3.0000000, 0.8520059,-2.386935,-3.0069463, 1.6116273,-1.62781373, 2.928950)

  thetaVector[[2]][1,] <- c(1.2456005, 2.082875,0.5802485,1.0857512,3.0888851,-1.798201,3.068337)
  thetaVector[[2]][2,] <- c(0.9577445, 2.491427,1.5096398,1.0030541,0.9038489, 3.014610,3.012517)
  thetaVector[[2]][3,] <- c(1.9818805, 1.492868,2.5017794,1.0954172,1.2720129, 3.004684,4.002619)
  thetaVector[[2]][4,] <- c(1.1371135,-4.905490,2.6899136,0.1846345,0.3865531,-6.111258,2.312163)
  thetaVector[[3]][1,] <- c(-1.373597,-0.7641775,-1.398335,-1.383123,8.038285)
  
  # (1,45,0,0,0,0,0,0,0,0,0,0,0,0,1.90,1,82,0.73,112)
  # nodes1 <-as.numeric(test_set[i,c(-10)])                   # input layer i.e layer1
  nodes2 <- c(1,as.numeric(thetaVector[[1]] %*% nodes1))     # hidden layer1 i.e layer2
  nodes2[-1] <- 1/(1+exp(-nodes2[-1]))
  nodes3 <- c(1,as.numeric(thetaVector[[2]] %*% nodes2))     # hidden layer2 i.e layer3
  nodes3[-1] <- 1/(1+exp(-nodes3[-1]))
  h <- sum(as.numeric(thetaVector[[3]] * nodes3))               # output layer i.e layer4
  h <- 1/(1+exp(-h))
  
  # saving the vector in a .txt file
  thetaVectorSave <- h
  write(thetaVectorSave, file = "thyroid_output.txt",
        ncolumns = if(is.character(thetaVectorSave)) 1 else 11,
        append = FALSE, sep = " ")
}
